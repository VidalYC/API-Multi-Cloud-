# üìö SUSTENTACI√ìN COMPLETA DEL PROYECTO
## API Multi-Cloud VM Provisioning con Patrones Factory y Builder

**Universidad Popular del Cesar**
**Especializaci√≥n en Ingenier√≠a de Software**
**Asignatura:** Patrones de Dise√±o de Software
**Actividad:** WS3 - Builder Pattern Integration

---

## üìã TABLA DE CONTENIDOS

1. [Cumplimiento de Requisitos del PDF](#1-cumplimiento-de-requisitos-del-pdf)
2. [Gu√≠a de Pruebas Paso a Paso](#2-gu√≠a-de-pruebas-paso-a-paso)
3. [Sustentaci√≥n T√©cnica Detallada](#3-sustentaci√≥n-t√©cnica-detallada)
4. [Patrones de Dise√±o Implementados](#4-patrones-de-dise√±o-implementados)
5. [Principios SOLID Aplicados](#5-principios-solid-aplicados)
6. [Arquitectura del Sistema](#6-arquitectura-del-sistema)
7. [An√°lisis de C√≥digo](#7-an√°lisis-de-c√≥digo)

---

## 1. CUMPLIMIENTO DE REQUISITOS DEL PDF

### üìä Tabla de Cumplimiento - Requisitos Funcionales (RF)

| ID | Requisito | Estado | Evidencia |
|----|-----------|--------|-----------|
| **RF1** | La API debe permitir crear m√°quinas virtuales en diferentes proveedores (AWS, Azure, GCP, On-Premise) | ‚úÖ **CUMPLIDO** | - 4 builders concretos implementados<br>- Endpoints `/api/vm/provision` y `/api/vm/build`<br>- Tests: `test_build_all_providers()` |
| **RF2** | Cada VM debe asociarse a una red y almacenamiento del mismo proveedor | ‚úÖ **CUMPLIDO** | - M√©todo `build()` crea Network y Storage<br>- Coherencia de proveedor garantizada<br>- Ver l√≠neas 363-378 en `aws_builder.py` |
| **RF3** | Debe existir un Director que orqueste el proceso de construcci√≥n (Builder) seg√∫n el tipo de VM | ‚úÖ **CUMPLIDO** | - Clase `VMDirector` en `domain/builder.py`<br>- M√©todos: `build_minimal_vm()`, `build_standard_vm()`, `build_high_performance_vm()`<br>- Endpoint `/api/vm/build/preset` |
| **RF4** | El Director debe asignar valores de vCPU y memoria RAM seg√∫n el tipo de m√°quina y proveedor | ‚úÖ **CUMPLIDO** | - Configuraciones espec√≠ficas por proveedor<br>- Mapeo de CPU/RAM en cada builder<br>- Ver l√≠neas 84-104 en `aws_builder.py` |
| **RF5** | Los recursos deben validarse para garantizar coherencia de regi√≥n y proveedor | ‚úÖ **CUMPLIDO** | - Validaci√≥n en construcci√≥n<br>- Mismo proveedor para VM, Network, Storage<br>- Pydantic schemas para validaci√≥n |

### üìä Tabla de Cumplimiento - Requisitos No Funcionales (RNF)

| ID | Requisito | Estado | Evidencia |
|----|-----------|--------|-----------|
| **RNF1** | **Modularidad:** Separaci√≥n clara entre Factory, Builder y Director | ‚úÖ **CUMPLIDO** | - `VMProviderFactory` en `application/factory.py`<br>- `VMBuilder` en `domain/builder.py`<br>- `VMDirector` en `domain/builder.py`<br>- Separaci√≥n por capas (Domain, Application, Infrastructure) |
| **RNF2** | **Extensibilidad:** Agregar nuevos tipos de VM o proveedores sin cambiar c√≥digo existente | ‚úÖ **CUMPLIDO** | - Patr√≥n Open/Closed aplicado<br>- `register_provider()` para nuevos proveedores<br>- Abstracciones permiten extensi√≥n<br>- Test: `test_ocp_open_closed()` |
| **RNF3** | **Validaci√≥n cruzada:** Coherencia de proveedor y regi√≥n entre recursos | ‚úÖ **CUMPLIDO** | - Builders crean recursos del mismo proveedor<br>- Network y Storage comparten regi√≥n/ubicaci√≥n<br>- Validaci√≥n en `build()` de cada builder |
| **RNF4** | **Escalabilidad:** Arquitectura debe soportar m√∫ltiples despliegues simult√°neos | ‚úÖ **CUMPLIDO** | - API Stateless (sin estado compartido)<br>- Sin sesiones en memoria<br>- Patr√≥n Factory permite instancias independientes<br>- Flask CORS habilitado |
| **RNF5** | **Legibilidad:** C√≥digo entendible como material de ense√±anza | ‚úÖ **CUMPLIDO** | - Documentaci√≥n exhaustiva (README, comentarios)<br>- Nombres descriptivos de clases y m√©todos<br>- Arquitectura limpia y clara<br>- 80+ tests como ejemplos de uso |

### üìä Tabla de Par√°metros Adicionales - VirtualMachine

| Atributo | Descripci√≥n | Obligatorio | Implementado | Ubicaci√≥n |
|----------|-------------|-------------|--------------|-----------|
| `provider` | Proveedor de nube | ‚úÖ | ‚úÖ | `MachineVirtual.provider` en entities.py |
| `vcpus` | N√∫cleos virtuales asignados | ‚úÖ | ‚úÖ | Configurado en `set_compute_resources()` |
| `memoryGB` | Memoria RAM asignada | ‚úÖ | ‚úÖ | Configurado en `set_compute_resources()` |
| `memoryOptimization` | Optimizaci√≥n de memoria | ‚ùå | ‚úÖ | En `advanced_options` de builders |
| `diskOptimization` | Optimizaci√≥n de disco | ‚ùå | ‚úÖ | En `advanced_options` de builders |
| `keyPairName` | Clave SSH o autenticaci√≥n | ‚ùå | ‚úÖ | En `advanced_options` de builders |

### üìä Tabla de Par√°metros Adicionales - Network

| Atributo | Descripci√≥n | Obligatorio | Implementado | Ubicaci√≥n |
|----------|-------------|-------------|--------------|-----------|
| `region` | Regi√≥n de red | ‚úÖ | ‚úÖ | `set_location()` en builders |
| `firewallRules` | Reglas de seguridad | ‚ùå | ‚úÖ | En `advanced_options` |
| `publicIP` | IP p√∫blica asignada | ‚ùå | ‚úÖ | En `advanced_options` |

### üìä Tabla de Par√°metros Adicionales - Storage

| Atributo | Descripci√≥n | Obligatorio | Implementado | Ubicaci√≥n |
|----------|-------------|-------------|--------------|-----------|
| `region` | Regi√≥n del almacenamiento | ‚úÖ | ‚úÖ | Heredada de `set_location()` |
| `iops` | Rendimiento del disco | ‚ùå | ‚úÖ | En `advanced_options` |

### üìä Tipos de M√°quina por Proveedor - Implementaci√≥n

#### Amazon AWS

| Categor√≠a | Tipo | vCPU | RAM | Implementado |
|-----------|------|------|-----|--------------|
| **General Purpose** | t3.medium | 2 | 4 GiB | ‚úÖ Mapeo en `set_compute_resources()` |
| | m5.large | 2 | 8 GiB | ‚úÖ |
| | m5.xlarge | 4 | 16 GiB | ‚úÖ |
| **Memory-Optimized** | r5.large | 2 | 16 GiB | ‚úÖ Preset `high-performance` |
| | r5.xlarge | 4 | 32 GiB | ‚úÖ |
| | r5.2xlarge | 8 | 64 GiB | ‚úÖ |
| **Compute-Optimized** | c5.large | 2 | 4 GiB | ‚úÖ |
| | c5.xlarge | 4 | 8 GiB | ‚úÖ |
| | c5.2xlarge | 8 | 16 GiB | ‚úÖ |

**Ubicaci√≥n en c√≥digo:** `infrastructure/builders/aws_builder.py` l√≠neas 84-104

#### Microsoft Azure

| Categor√≠a | Tipo | vCPU | RAM | Implementado |
|-----------|------|------|-----|--------------|
| **Standard/General Purpose** | D2s_v3 | 2 | 8 GiB | ‚úÖ |
| | D4s_v3 | 4 | 16 GiB | ‚úÖ |
| | D8s_v3 | 8 | 32 GiB | ‚úÖ |
| **Memory-Optimized** | E2s_v3 | 2 | 16 GiB | ‚úÖ |
| | E4s_v3 | 4 | 32 GiB | ‚úÖ |
| | E8s_v3 | 8 | 64 GiB | ‚úÖ |
| **Compute-Optimized** | F2s_v2 | 2 | 4 GiB | ‚úÖ |
| | F4s_v2 | 4 | 8 GiB | ‚úÖ |
| | F8s_v2 | 8 | 16 GiB | ‚úÖ |

**Ubicaci√≥n en c√≥digo:** `infrastructure/builders/azure_builder.py` l√≠neas 76-96

#### Google Cloud Platform (GCP)

| Categor√≠a | Tipo | vCPU | RAM | Implementado |
|-----------|------|------|-----|--------------|
| **Standard/General Purpose** | e2-standard-2 | 2 | 8 GiB | ‚úÖ |
| | e2-standard-4 | 4 | 16 GiB | ‚úÖ |
| | e2-standard-8 | 8 | 32 GiB | ‚úÖ |
| **Memory-Optimized** | n2-highmem-2 | 2 | 16 GiB | ‚úÖ |
| | n2-highmem-4 | 4 | 32 GiB | ‚úÖ |
| | n2-highmem-8 | 8 | 64 GiB | ‚úÖ |
| **Compute-Optimized** | n2-highcpu-2 | 2 | 2 GiB | ‚úÖ |
| | n2-highcpu-4 | 4 | 4 GiB | ‚úÖ |
| | n2-highcpu-8 | 8 | 8 GiB | ‚úÖ |

**Ubicaci√≥n en c√≥digo:** `infrastructure/builders/google_builder.py` l√≠neas 76-96

#### On-Premise (Simulaci√≥n)

| Categor√≠a | Tipo | vCPU | RAM | Implementado |
|-----------|------|------|-----|--------------|
| **Standard** | onprem-std1 | 2 | 4 GiB | ‚úÖ |
| | onprem-std2 | 4 | 8 GiB | ‚úÖ |
| | onprem-std3 | 8 | 16 GiB | ‚úÖ |
| **Memory-Optimized** | onprem-mem1 | 2 | 16 GiB | ‚úÖ |
| | onprem-mem2 | 4 | 32 GiB | ‚úÖ |
| | onprem-mem3 | 8 | 64 GiB | ‚úÖ |
| **Compute-Optimized** | onprem-cpu1 | 2 | 2 GiB | ‚úÖ |
| | onprem-cpu2 | 4 | 4 GiB | ‚úÖ |
| | onprem-cpu3 | 8 | 8 GiB | ‚úÖ |

**Ubicaci√≥n en c√≥digo:** `infrastructure/builders/onpremise_builder.py` l√≠neas 55-63

---

## 2. GU√çA DE PRUEBAS PASO A PASO

### üîß Preparaci√≥n del Entorno

#### Paso 1: Verificar Instalaci√≥n

```bash
# 1. Navegar al directorio del proyecto
cd "c:\Users\yorie\Downloads\Patrones\Corte 2\API-Proveedores"

# 2. Verificar versi√≥n de Python (debe ser 3.8+)
python --version

# 3. Instalar dependencias
pip install -r requirements.txt
```

**Salida esperada:**
```
Successfully installed flask-3.0.0 flask-cors-4.0.0 pydantic-2.x.x ...
```

#### Paso 2: Ejecutar Tests Unitarios

```bash
# Test 1: Factory Pattern (31 tests)
python tests/test_all.py
```

**Resultado esperado:**
```
======================================================================
RESUMEN DE TESTS
======================================================================
Tests ejecutados: 31
Exitosos: 31
Fallidos: 0
Errores: 0
======================================================================
```

```bash
# Test 2: Builder Pattern (32 tests)
python tests/test_builder.py
```

**Resultado esperado:**
```
======================================================================
RESUMEN DE TESTS DE BUILDER PATTERN
======================================================================
Tests ejecutados: 32
Exitosos: 32
Fallidos: 0
Errores: 0
======================================================================
```

**‚úÖ Verificaci√≥n:** Si ambos tests pasan con 0 errores, el sistema est√° funcionando correctamente.

---

### üöÄ Pruebas de la API REST

#### Paso 3: Iniciar el Servidor

```bash
# En una terminal, ejecutar:
python api/main.py
```

**Salida esperada:**
```
INFO:werkzeug: * Running on http://127.0.0.1:5000
INFO:root:Iniciando VM Provisioning API...
INFO:root:Proveedores disponibles: ['aws', 'azure', 'google', 'gcp', 'onpremise', 'on-premise']
```

**‚ö†Ô∏è Importante:** Mant√©n esta terminal abierta durante las pruebas.

---

#### Paso 4: Pruebas de Endpoints (En otra terminal)

##### Prueba 4.1: Health Check

```bash
curl http://localhost:5000/health
```

**Resultado esperado:**
```json
{
  "status": "healthy",
  "service": "VM Provisioning API",
  "version": "1.0.0"
}
```

**‚úÖ Verificaci√≥n:** Status debe ser "healthy"

---

##### Prueba 4.2: Listar Proveedores

```bash
curl http://localhost:5000/api/providers
```

**Resultado esperado:**
```json
{
  "success": true,
  "providers": [
    "aws",
    "azure",
    "google",
    "gcp",
    "onpremise",
    "on-premise"
  ],
  "count": 6
}
```

**‚úÖ Verificaci√≥n:** Deben aparecer los 4 proveedores principales + 2 alias

---

##### Prueba 4.3: Factory Pattern - Provisi√≥n R√°pida AWS

```bash
curl -X POST http://localhost:5000/api/vm/provision \
  -H "Content-Type: application/json" \
  -d "{\"provider\":\"aws\",\"config\":{\"type\":\"t2.micro\",\"region\":\"us-east-1\"}}"
```

**Resultado esperado:**
```json
{
  "success": true,
  "vm_id": "aws-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "message": "VM creada exitosamente en aws",
  "provider": "aws",
  "vm_details": {
    "vmId": "aws-xxxxxxxx...",
    "name": "aws-t2.micro-us-east-1-xxxx",
    "status": "running",
    "provider": "aws",
    "network": {
      "networkId": "vpc-xxxxxxxx",
      "name": "aws-net-us-east-1",
      "cidr_block": "10.0.0.0/16"
    },
    "disks": [...]
  }
}
```

**‚úÖ Verificaci√≥n:**
- `success: true`
- `vm_id` comienza con "aws-"
- `status: "running"`
- Network y Disks est√°n presentes

---

##### Prueba 4.4: Builder Pattern - Construcci√≥n Personalizada Azure

```bash
curl -X POST http://localhost:5000/api/vm/build \
  -H "Content-Type: application/json" \
  -d "{\"provider\":\"azure\",\"build_config\":{\"name\":\"production-db\",\"vm_type\":\"high-performance\",\"cpu\":8,\"ram\":32,\"disk_gb\":500,\"disk_type\":\"ssd\",\"location\":\"eastus\",\"advanced_options\":{\"monitoring\":true,\"resource_group\":\"production\"}}}"
```

**Resultado esperado:**
```json
{
  "success": true,
  "vm_id": "azure-xxxxxxxx...",
  "message": "VM construida exitosamente en azure usando Builder Pattern",
  "provider": "azure",
  "vm_details": {
    "vmId": "azure-xxxxxxxx...",
    "name": "production-db",
    "status": "running",
    "provider": "azure"
  }
}
```

**‚úÖ Verificaci√≥n:**
- Mensaje menciona "Builder Pattern"
- Nombre personalizado "production-db"
- Configuraci√≥n avanzada aplicada

---

##### Prueba 4.5: Director Pattern - VM Predefinida Minimal

```bash
curl -X POST http://localhost:5000/api/vm/build/preset \
  -H "Content-Type: application/json" \
  -d "{\"provider\":\"google\",\"preset\":\"minimal\",\"name\":\"test-vm\",\"location\":\"us-central1-a\"}"
```

**Resultado esperado:**
```json
{
  "success": true,
  "vm_id": "gcp-xxxxxxxx...",
  "message": "VM 'minimal' construida exitosamente en google",
  "provider": "google",
  "vm_details": {
    "name": "test-vm",
    "status": "running"
  }
}
```

**‚úÖ Verificaci√≥n:**
- Configuraci√≥n "minimal" aplicada (1 CPU, 1GB RAM, 10GB Disk)
- Creaci√≥n r√°pida con Director

---

##### Prueba 4.6: Director Pattern - VM Predefinida High-Performance

```bash
curl -X POST http://localhost:5000/api/vm/build/preset \
  -H "Content-Type: application/json" \
  -d "{\"provider\":\"onpremise\",\"preset\":\"high-performance\",\"name\":\"analytics-server\",\"location\":\"datacenter-1\"}"
```

**Resultado esperado:**
```json
{
  "success": true,
  "vm_id": "onprem-xxxxxxxx...",
  "message": "VM 'high-performance' construida exitosamente en onpremise",
  "provider": "on-premise",
  "vm_details": {
    "name": "analytics-server",
    "status": "running"
  }
}
```

**‚úÖ Verificaci√≥n:**
- Configuraci√≥n "high-performance" (8 CPU, 32GB RAM, 500GB Disk)
- Proveedor on-premise funciona correctamente

---

##### Prueba 4.7: Manejo de Errores - Proveedor Inv√°lido

```bash
curl -X POST http://localhost:5000/api/vm/provision \
  -H "Content-Type: application/json" \
  -d "{\"provider\":\"invalid-cloud\",\"config\":{}}"
```

**Resultado esperado:**
```json
{
  "success": false,
  "message": "Proveedor 'invalid-cloud' no soportado",
  "error_detail": "Proveedores disponibles: aws, azure, google, onpremise",
  "provider": "invalid-cloud"
}
```

**‚úÖ Verificaci√≥n:**
- `success: false`
- Mensaje de error descriptivo
- Lista de proveedores v√°lidos

---

##### Prueba 4.8: Validaci√≥n - Par√°metros Faltantes

```bash
curl -X POST http://localhost:5000/api/vm/build/preset \
  -H "Content-Type: application/json" \
  -d "{\"provider\":\"aws\"}"
```

**Resultado esperado:**
```json
{
  "success": false,
  "error": "Par√°metro \"preset\" es requerido",
  "example": {
    "provider": "aws",
    "preset": "standard",
    "name": "my-vm",
    "location": "us-east-1"
  }
}
```

**‚úÖ Verificaci√≥n:**
- Error claro sobre par√°metro faltante
- Ejemplo de uso correcto incluido

---

### üìä Tabla Resumen de Pruebas

| # | Tipo de Prueba | Endpoint | Patr√≥n Usado | Estado Esperado |
|---|----------------|----------|--------------|-----------------|
| 4.1 | Health Check | GET /health | - | 200 OK |
| 4.2 | Listar Proveedores | GET /api/providers | - | 200 OK, 6 proveedores |
| 4.3 | Provisi√≥n R√°pida | POST /api/vm/provision | Factory | 200 OK, VM creada |
| 4.4 | Construcci√≥n Custom | POST /api/vm/build | Builder | 200 OK, VM personalizada |
| 4.5 | Preset Minimal | POST /api/vm/build/preset | Director | 200 OK, VM minimal |
| 4.6 | Preset High-Perf | POST /api/vm/build/preset | Director | 200 OK, VM potente |
| 4.7 | Error - Proveedor | POST /api/vm/provision | Factory | 400 Bad Request |
| 4.8 | Error - Validaci√≥n | POST /api/vm/build/preset | Director | 400 Bad Request |

---

### üéØ Prueba Automatizada Completa

Para ejecutar todas las pruebas autom√°ticamente:

```bash
# En una terminal (con el servidor corriendo en otra)
python test_examples.py
```

Este script ejecutar√° autom√°ticamente las 7 pruebas principales y mostrar√° los resultados.

**Resultado esperado:**
```
========================================
EJEMPLOS DE USO DE LA API MULTI-CLOUD
========================================

TEST 1: Health Check
Status Code: 200
Response: {...}

TEST 2: Listar Proveedores
Status Code: 200
Response: {...}

... (contin√∫a con todos los tests)

========================================
‚úÖ TODOS LOS TESTS COMPLETADOS
========================================
```

---

## 3. SUSTENTACI√ìN T√âCNICA DETALLADA

### üéì ¬øQu√© es este Proyecto?

Este proyecto es una **API REST para aprovisionamiento multi-cloud** que permite crear m√°quinas virtuales en diferentes proveedores de nube (AWS, Azure, Google Cloud, On-Premise) de manera **flexible, escalable y mantenible**.

### üß© Problema que Resuelve

**Problema Original:**
- Cada proveedor cloud tiene su propia API y forma de crear recursos
- Dif√≠cil mantener c√≥digo que soporte m√∫ltiples proveedores
- Configuraciones complejas dificultan la creaci√≥n de VMs personalizadas
- No hay forma estandarizada de crear VMs con configuraciones predefinidas

**Soluci√≥n Implementada:**
- **Factory Pattern:** Crea proveedores de forma din√°mica sin acoplar el c√≥digo
- **Builder Pattern:** Permite construcci√≥n paso a paso de VMs con cualquier configuraci√≥n
- **Director Pattern:** Encapsula configuraciones predefinidas (minimal, standard, high-performance)
- **API REST:** Interfaz unificada para todos los proveedores

### üèóÔ∏è ¬øPor Qu√© Estos Patrones?

#### Factory Method Pattern

**¬øQu√© es?**
Un patr√≥n creacional que define una interfaz para crear objetos pero permite a las subclases decidir qu√© clase instanciar.

**¬øPor qu√© lo usamos?**
1. **Desacoplamiento:** El c√≥digo cliente no necesita conocer las clases concretas (AWS, Azure, etc.)
2. **Extensibilidad:** Agregar nuevos proveedores no requiere modificar c√≥digo existente (OCP)
3. **Polimorfismo:** Todos los proveedores implementan la misma interfaz `ProveedorAbstracto`

**¬øD√≥nde est√° implementado?**
- **Interfaz Creator:** `ProveedorAbstracto` en `domain/interfaces.py`
- **Concrete Creators:** `AWS`, `Azure`, `Google`, `OnPremise` en `infrastructure/providers/`
- **Factory:** `VMProviderFactory` en `application/factory.py`

**Ejemplo de c√≥digo:**
```python
# Cliente no conoce la clase concreta
provider = VMProviderFactory.create_provider('aws', config)
# Retorna ProveedorAbstracto (abstracci√≥n), no AWS (implementaci√≥n)
vm = provider.provisionar()  # Polimorfismo en acci√≥n
```

**Beneficios en el proyecto:**
- ‚úÖ Agregar Oracle Cloud solo requiere crear clase `Oracle` y registrarla
- ‚úÖ El servicio `VMProvisioningService` no cambia al agregar proveedores
- ‚úÖ Tests pueden usar mocks sin cambiar el c√≥digo

---

#### Builder Pattern

**¬øQu√© es?**
Un patr√≥n creacional que permite construir objetos complejos paso a paso. Permite producir diferentes tipos y representaciones de un objeto usando el mismo c√≥digo de construcci√≥n.

**¬øPor qu√© lo usamos?**
1. **Construcci√≥n Compleja:** VMs requieren configurar m√∫ltiples aspectos (CPU, RAM, disco, red, opciones avanzadas)
2. **Construcci√≥n Opcional:** No todos los par√°metros son obligatorios
3. **Legibilidad:** C√≥digo m√°s legible con fluent interface
4. **Flexibilidad:** Diferentes configuraciones sin constructores telesc√≥picos

**¬øD√≥nde est√° implementado?**
- **Builder Interface:** `VMBuilder` en `domain/builder.py`
- **Concrete Builders:** `AWSVMBuilder`, `AzureVMBuilder`, `GoogleVMBuilder`, `OnPremiseVMBuilder` en `infrastructure/builders/`
- **Product:** `MachineVirtual` en `domain/entities.py`

**Ejemplo de c√≥digo:**
```python
# Construcci√≥n paso a paso
vm = (builder
      .reset()
      .set_basic_config("prod-server", "high-performance")
      .set_compute_resources(cpu=8, ram=32)
      .set_storage(size_gb=500, disk_type="ssd")
      .set_network(network_id="vpc-prod", cidr="10.0.0.0/16")
      .set_location("us-east-1")
      .set_advanced_options({"monitoring": True, "optimized": True})
      .build())
```

**Beneficios en el proyecto:**
- ‚úÖ Construcci√≥n legible y mantenible
- ‚úÖ Par√°metros opcionales sin constructores complicados
- ‚úÖ Fluent Interface (encadenamiento de m√©todos)
- ‚úÖ Cada builder maneja l√≥gica espec√≠fica de su proveedor

---

#### Director Pattern

**¬øQu√© es?**
Una extensi√≥n del Builder que define el orden y los pasos para construir configuraciones predefinidas.

**¬øPor qu√© lo usamos?**
1. **Reutilizaci√≥n:** Configuraciones comunes (minimal, standard, high-performance)
2. **Consistencia:** Misma configuraci√≥n "standard" en todos los proveedores
3. **Best Practices:** Encapsula conocimiento de configuraciones √≥ptimas
4. **Simplicidad:** Usuarios no necesitan conocer todos los par√°metros

**¬øD√≥nde est√° implementado?**
- **Director:** `VMDirector` en `domain/builder.py`
- **M√©todos:** `build_minimal_vm()`, `build_standard_vm()`, `build_high_performance_vm()`

**Ejemplo de c√≥digo:**
```python
# Sin Director (complejo)
vm = builder.reset().set_basic_config(...).set_compute_resources(...)...

# Con Director (simple)
director = VMDirector(builder)
vm = director.build_high_performance_vm("analytics-server", "us-east-1")
```

**Beneficios en el proyecto:**
- ‚úÖ Usuarios pueden crear VMs sin conocer par√°metros t√©cnicos
- ‚úÖ Configuraciones probadas y optimizadas
- ‚úÖ Reduce errores de configuraci√≥n
- ‚úÖ Facilita deployments r√°pidos

---

### üîÑ ¬øC√≥mo Interact√∫an los Patrones?

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        CLIENTE (API)                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ                   ‚îÇ
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ Factory Pattern ‚îÇ ‚îÇ Builder Pattern‚îÇ
           ‚îÇ                 ‚îÇ ‚îÇ                ‚îÇ
           ‚îÇ Provisi√≥n       ‚îÇ ‚îÇ Construcci√≥n   ‚îÇ
           ‚îÇ R√°pida          ‚îÇ ‚îÇ Personalizada  ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ                   ‚îÇ
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ VMProviderFactory‚îÇ ‚îÇ VMBuilderFactory‚îÇ
           ‚îÇ create_provider()‚îÇ ‚îÇ create_builder()‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ                   ‚îÇ
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ  AWS Provider   ‚îÇ ‚îÇ  AWSVMBuilder  ‚îÇ
           ‚îÇ  provisionar()  ‚îÇ ‚îÇ  build()       ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚îÇ                   ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  MachineVirtual   ‚îÇ
                    ‚îÇ  + Network        ‚îÇ
                    ‚îÇ  + Storage        ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Flujo de Ejecuci√≥n:**

1. **Cliente hace request** ‚Üí Llega a API Flask
2. **API decide:** ¬øFactory o Builder?
   - `/api/vm/provision` ‚Üí `VMProvisioningService` (Factory)
   - `/api/vm/build` ‚Üí `VMBuildingService` (Builder)
3. **Service crea Factory/Builder** seg√∫n proveedor
4. **Factory/Builder construye VM** con Network y Storage
5. **Service retorna resultado** como JSON al cliente

---

### üì¶ Arquitectura de Capas

El proyecto sigue **Clean Architecture** (Arquitectura Limpia):

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    API Layer (Flask)                     ‚îÇ
‚îÇ  - Recibe requests HTTP                                  ‚îÇ
‚îÇ  - Valida formato JSON                                   ‚îÇ
‚îÇ  - Retorna responses                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ Depende de ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Application Layer (Services)                ‚îÇ
‚îÇ  - VMProvisioningService (Factory)                       ‚îÇ
‚îÇ  - VMBuildingService (Builder)                           ‚îÇ
‚îÇ  - Orquesta l√≥gica de negocio                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ Depende de ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Domain Layer (Abstracciones)                ‚îÇ
‚îÇ  - ProveedorAbstracto (interface)                        ‚îÇ
‚îÇ  - VMBuilder (abstract class)                            ‚îÇ
‚îÇ  - VMDirector                                            ‚îÇ
‚îÇ  - Entities (MachineVirtual, Network, Storage)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ Implementado por ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Infrastructure Layer (Implementaciones)          ‚îÇ
‚îÇ  - Providers concretos (AWS, Azure, Google, OnPremise)  ‚îÇ
‚îÇ  - Builders concretos (AWSVMBuilder, etc.)              ‚îÇ
‚îÇ  - L√≥gica espec√≠fica de cada proveedor                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Principio de Inversi√≥n de Dependencias (DIP):**
- ‚úÖ Capas superiores dependen de abstracciones (interfaces)
- ‚úÖ Capas superiores NO dependen de implementaciones concretas
- ‚úÖ Infrastructure implementa las abstracciones del Domain

**Beneficios:**
1. **Testabilidad:** Podemos mockear abstracciones en tests
2. **Mantenibilidad:** Cambios en infrastructure no afectan application/domain
3. **Reusabilidad:** Domain layer es independiente de frameworks
4. **Claridad:** Cada capa tiene responsabilidad √∫nica

---

## 4. PATRONES DE DISE√ëO IMPLEMENTADOS

### üî∑ 1. Factory Method Pattern

**Definici√≥n:**
> Define una interfaz para crear un objeto, pero deja que las subclases decidan qu√© clase instanciar.

**Implementaci√≥n en el Proyecto:**

**Participantes:**
1. **Product (Abstracci√≥n):** `ProveedorAbstracto`
2. **Concrete Products:** `AWS`, `Azure`, `Google`, `OnPremise`
3. **Creator:** `VMProviderFactory`

**C√≥digo Clave:**

```python
# domain/interfaces.py
class ProveedorAbstracto(ABC):
    """Product - Interfaz com√∫n para todos los proveedores"""

    @abstractmethod
    def crear_vm(self) -> MachineVirtual:
        """Factory Method - Cada proveedor implementa su l√≥gica"""
        pass

    def provisionar(self) -> MachineVirtual:
        """Template Method - Orquesta la creaci√≥n"""
        return self.crear_vm()
```

```python
# infrastructure/providers/aws.py
class AWS(ProveedorAbstracto):
    """Concrete Product - Implementaci√≥n espec√≠fica de AWS"""

    def crear_vm(self) -> MachineVirtual:
        # L√≥gica espec√≠fica de AWS
        vm_id = f"aws-{uuid.uuid4()}"
        # ... crear network, storage, vm
        return vm
```

```python
# application/factory.py
class VMProviderFactory:
    """Creator - Factory que crea productos"""

    _providers = {
        'aws': AWS,
        'azure': Azure,
        'google': Google,
        'onpremise': OnPremise
    }

    @classmethod
    def create_provider(cls, provider_type: str, config: Dict) -> ProveedorAbstracto:
        """Factory Method - Retorna abstracci√≥n, no implementaci√≥n"""
        provider_class = cls._providers.get(provider_type)
        return provider_class(config)
```

**¬øC√≥mo Funciona?**

1. Cliente pide crear VM para "aws"
2. Factory busca clase asociada a "aws" en el diccionario
3. Factory instancia la clase (AWS) y retorna como `ProveedorAbstracto`
4. Cliente usa m√©todos de la interfaz, no de la clase concreta

**Ventajas:**
- ‚úÖ Cliente desacoplado de clases concretas
- ‚úÖ F√°cil agregar nuevos proveedores (registrar en diccionario)
- ‚úÖ Principio Open/Closed aplicado
- ‚úÖ Polimorfismo permite tratar todos los proveedores igual

**Diagrama UML Simplificado:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ProveedorAbstracto     ‚îÇ <<interface>>
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ + crear_vm()            ‚îÇ
‚îÇ + provisionar()         ‚îÇ
‚îÇ + estado()              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
            ‚îÇ Implementa
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ               ‚îÇ          ‚îÇ          ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  AWS   ‚îÇ  ‚îÇ  Azure   ‚îÇ ‚îÇ Google   ‚îÇ ‚îÇ OnPremise ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇcrear_vm‚îÇ  ‚îÇcrear_vm  ‚îÇ ‚îÇcrear_vm  ‚îÇ ‚îÇcrear_vm   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### üî∑ 2. Builder Pattern

**Definici√≥n:**
> Separa la construcci√≥n de un objeto complejo de su representaci√≥n, permitiendo el mismo proceso de construcci√≥n crear diferentes representaciones.

**Implementaci√≥n en el Proyecto:**

**Participantes:**
1. **Builder (Interfaz):** `VMBuilder`
2. **Concrete Builders:** `AWSVMBuilder`, `AzureVMBuilder`, `GoogleVMBuilder`, `OnPremiseVMBuilder`
3. **Product:** `MachineVirtual`
4. **Director:** `VMDirector`

**C√≥digo Clave:**

```python
# domain/builder.py
class VMBuilder(ABC):
    """Builder - Define pasos de construcci√≥n"""

    @abstractmethod
    def reset(self) -> 'VMBuilder':
        """Reinicia el builder"""
        pass

    @abstractmethod
    def set_basic_config(self, name: str, vm_type: str) -> 'VMBuilder':
        """Paso 1: Configuraci√≥n b√°sica"""
        pass

    @abstractmethod
    def set_compute_resources(self, cpu: int, ram: int) -> 'VMBuilder':
        """Paso 2: Recursos de c√≥mputo"""
        pass

    @abstractmethod
    def set_storage(self, size_gb: int, disk_type: str) -> 'VMBuilder':
        """Paso 3: Almacenamiento"""
        pass

    @abstractmethod
    def set_network(self, network_id: str, cidr: str) -> 'VMBuilder':
        """Paso 4: Red"""
        pass

    @abstractmethod
    def build(self) -> MachineVirtual:
        """Construye el producto final"""
        pass
```

```python
# infrastructure/builders/aws_builder.py
class AWSVMBuilder(VMBuilder):
    """Concrete Builder - Construcci√≥n espec√≠fica de AWS"""

    def __init__(self):
        self._config = {'provider': 'aws', 'region': 'us-east-1'}

    def set_basic_config(self, name: str, vm_type: str) -> 'AWSVMBuilder':
        self._config['name'] = name
        self._config['instance_type'] = self._map_vm_type(vm_type)
        return self  # Fluent Interface

    def set_compute_resources(self, cpu: int, ram: int) -> 'AWSVMBuilder':
        # L√≥gica de mapeo CPU/RAM a instance type de AWS
        if cpu <= 2 and ram <= 4:
            self._config['instance_type'] = 't2.small'
        elif cpu <= 4 and ram <= 16:
            self._config['instance_type'] = 't2.large'
        # ... m√°s mappings
        return self

    def build(self) -> MachineVirtual:
        # Construye Network, Storage y VM
        network = Network(...)
        disk = StorageDisk(...)
        vm = MachineVirtual(network=network, disks=[disk], ...)
        return vm
```

**¬øC√≥mo Funciona?**

1. **Cliente obtiene builder:** `builder = AWSVMBuilder()`
2. **Cliente configura paso a paso:**
   ```python
   builder.reset()
          .set_basic_config("prod-vm", "high-performance")
          .set_compute_resources(cpu=8, ram=32)
          .set_storage(500, "ssd")
          .set_network("vpc-123", "10.0.0.0/16")
   ```
3. **Cliente construye producto:** `vm = builder.build()`
4. **Builder ensambla** Network + Storage + VM

**Ventajas:**
- ‚úÖ Construcci√≥n legible (Fluent Interface)
- ‚úÖ Par√°metros opcionales sin constructores telesc√≥picos
- ‚úÖ Misma interfaz para todos los proveedores
- ‚úÖ Cada builder maneja l√≥gica espec√≠fica de su proveedor

**Diagrama UML Simplificado:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      VMBuilder         ‚îÇ <<abstract>>
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ + reset()              ‚îÇ
‚îÇ + set_basic_config()   ‚îÇ
‚îÇ + set_compute_resources‚îÇ
‚îÇ + set_storage()        ‚îÇ
‚îÇ + set_network()        ‚îÇ
‚îÇ + build(): VM          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ               ‚îÇ            ‚îÇ            ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ AWSVMBuilder‚îÇ ‚îÇAzureVMBuild‚îÇ ‚îÇGoogleVMBld‚îÇ ‚îÇOnPremVMBld‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ build(): VM ‚îÇ ‚îÇ build(): VM‚îÇ ‚îÇbuild(): VM‚îÇ ‚îÇbuild(): VM‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### üî∑ 3. Director Pattern

**Definici√≥n:**
> Encapsula el orden y los pasos para construir configuraciones predefinidas usando un Builder.

**Implementaci√≥n en el Proyecto:**

**C√≥digo Clave:**

```python
# domain/builder.py
class VMDirector:
    """Director - Encapsula algoritmos de construcci√≥n"""

    def __init__(self, builder: VMBuilder):
        self._builder = builder

    def build_minimal_vm(self, name: str) -> MachineVirtual:
        """Preset: VM m√≠nima para testing"""
        return (self._builder
                .reset()
                .set_basic_config(name, "minimal")
                .set_compute_resources(cpu=1, ram=1)
                .set_storage(size_gb=10)
                .build())

    def build_standard_vm(self, name: str, location: str) -> MachineVirtual:
        """Preset: VM est√°ndar para aplicaciones web"""
        return (self._builder
                .reset()
                .set_basic_config(name, "standard")
                .set_location(location)
                .set_compute_resources(cpu=2, ram=4)
                .set_storage(size_gb=50)
                .set_network()
                .build())

    def build_high_performance_vm(self, name: str, location: str) -> MachineVirtual:
        """Preset: VM de alto rendimiento para bases de datos"""
        return (self._builder
                .reset()
                .set_basic_config(name, "high-performance")
                .set_location(location)
                .set_compute_resources(cpu=8, ram=32)
                .set_storage(size_gb=500, disk_type="ssd")
                .set_network()
                .set_advanced_options({"optimized": True})
                .build())
```

**¬øC√≥mo Funciona?**

1. **Cliente crea Director con builder:**
   ```python
   builder = AWSVMBuilder()
   director = VMDirector(builder)
   ```

2. **Cliente solicita preset:**
   ```python
   vm = director.build_high_performance_vm("analytics-db", "us-east-1")
   ```

3. **Director ejecuta secuencia predefinida** de pasos del builder

4. **Builder construye VM** seg√∫n los pasos del Director

**Ventajas:**
- ‚úÖ Configuraciones predefinidas reutilizables
- ‚úÖ Encapsula best practices de cada tipo de VM
- ‚úÖ Simplifica creaci√≥n para usuarios finales
- ‚úÖ Consistencia entre proveedores (mismo "standard" para todos)

**Diagrama de Colaboraci√≥n:**

```
Cliente
   ‚îÇ
   ‚îÇ 1. Crea
   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ VMDirector(builder)
   ‚îÇ
   ‚îÇ 2. Solicita preset
   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ director.build_high_performance_vm()
                      ‚îÇ
                      ‚îÇ 3. Ejecuta pasos
                      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ builder.reset()
                      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ builder.set_basic_config()
                      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ builder.set_compute_resources()
                      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ builder.set_storage()
                      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ builder.build()
                      ‚îÇ
                      ‚îÇ 4. Retorna
                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ MachineVirtual
```

---

### üî∑ 4. Abstract Factory Pattern (Impl√≠cito)

**Definici√≥n:**
> Proporciona una interfaz para crear familias de objetos relacionados sin especificar sus clases concretas.

**Implementaci√≥n en el Proyecto:**

Aunque no est√° expl√≠citamente nombrado, cada `ProveedorAbstracto` act√∫a como Abstract Factory al crear familias de recursos relacionados (VM + Network + Storage) del mismo proveedor.

**C√≥digo Clave:**

```python
# infrastructure/providers/aws.py
class AWS(ProveedorAbstracto):
    """Abstract Factory - Crea familia de recursos AWS"""

    def crear_vm(self) -> MachineVirtual:
        # Familia de productos AWS
        network = self._crear_network_aws()  # Producto 1
        disk = self._crear_storage_aws()     # Producto 2
        vm = self._crear_vm_aws(network, disk)  # Producto 3
        return vm

    def _crear_network_aws(self) -> Network:
        """Crea Network espec√≠fica de AWS"""
        return Network(
            networkId=f"vpc-{uuid.uuid4().hex[:8]}",
            cidr_block="10.0.0.0/16",
            provider='aws'  # Coherencia
        )

    def _crear_storage_aws(self) -> StorageDisk:
        """Crea Storage espec√≠fico de AWS"""
        return StorageDisk(
            diskId=f"vol-{uuid.uuid4().hex[:12]}",
            disk_type="gp2",
            provider='aws'  # Coherencia
        )
```

**Garant√≠a de Coherencia:**
- ‚úÖ Todos los recursos creados pertenecen al mismo proveedor
- ‚úÖ Network y Storage comparten regi√≥n
- ‚úÖ IDs siguen convenciones del proveedor (vpc- para AWS, disk- para GCP, etc.)

**Diagrama UML:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ProveedorAbstracto    ‚îÇ <<AbstractFactory>>
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ + crear_vm()           ‚îÇ
‚îÇ # _crear_network()     ‚îÇ
‚îÇ # _crear_storage()     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
            ‚îÇ Crea familia
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                      ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Network   ‚îÇ      ‚îÇ  Storage   ‚îÇ
‚îÇ  + provider‚îÇ      ‚îÇ  + provider‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 5. PRINCIPIOS SOLID APLICADOS

### üî∑ S - Single Responsibility Principle (SRP)

**Definici√≥n:**
> Una clase debe tener una, y solo una, raz√≥n para cambiar.

**Aplicaci√≥n en el Proyecto:**

#### Ejemplo 1: VMProviderFactory
```python
class VMProviderFactory:
    """
    Responsabilidad √öNICA: Crear proveedores
    No se encarga de:
    - Aprovisionar VMs
    - Validar configuraciones
    - Gestionar estado
    """

    @classmethod
    def create_provider(cls, provider_type: str, config: Dict) -> ProveedorAbstracto:
        # Solo crea y retorna proveedores
        provider_class = cls._providers.get(provider_type)
        return provider_class(config)
```

**‚úÖ Cumplimiento:**
- Solo cambia si la l√≥gica de creaci√≥n de proveedores cambia
- No cambia si cambia l√≥gica de aprovisionamiento
- No cambia si cambian validaciones

#### Ejemplo 2: VMProvisioningService
```python
class VMProvisioningService:
    """
    Responsabilidad √öNICA: Orquestar aprovisionamiento
    No se encarga de:
    - Crear proveedores (delega a Factory)
    - Validar esquemas (delega a Pydantic)
    - Crear VMs (delega a Provider)
    """

    def provision_vm(self, provider_type: str, config: Dict) -> ProvisioningResult:
        provider = self.orchestrator.get_validated_provider(provider_type, config)
        vm = provider.provisionar()
        return ProvisioningResult(success=True, vm_id=vm.vmId)
```

**‚úÖ Cumplimiento:**
- Solo cambia si la orquestaci√≥n cambia
- Delega creaci√≥n de proveedores
- Delega validaci√≥n de datos

#### Ejemplo 3: AWSVMBuilder
```python
class AWSVMBuilder(VMBuilder):
    """
    Responsabilidad √öNICA: Construir VMs de AWS
    No se encarga de:
    - Construir VMs de otros proveedores
    - Decidir qu√© configuraci√≥n usar (Director)
    - Gestionar el API de AWS real
    """
```

**Tabla de Responsabilidades:**

| Clase | √önica Responsabilidad | NO es responsable de |
|-------|----------------------|---------------------|
| VMProviderFactory | Crear proveedores | Aprovisionar, validar |
| VMProvisioningService | Orquestar aprovisionamiento | Crear proveedores, validar esquemas |
| AWSVMBuilder | Construir VMs de AWS | Builders de otros proveedores |
| VMDirector | Definir presets de construcci√≥n | Construir VMs (delega a Builder) |
| Network | Representar red | Crear VMs, Storage |
| StorageDisk | Representar disco | Crear VMs, Network |

---

### üî∑ O - Open/Closed Principle (OCP)

**Definici√≥n:**
> Las entidades de software deben estar abiertas para extensi√≥n, pero cerradas para modificaci√≥n.

**Aplicaci√≥n en el Proyecto:**

#### Ejemplo 1: Agregar Nuevo Proveedor (Sin modificar c√≥digo)

**ANTES de agregar Oracle Cloud:**
```python
# application/factory.py
class VMProviderFactory:
    _providers = {
        'aws': AWS,
        'azure': Azure,
        'google': Google,
        'onpremise': OnPremise
    }
```

**DESPU√âS de agregar Oracle Cloud (Sin cambiar Factory):**
```python
# 1. Crear nueva clase (EXTENSI√ìN)
# infrastructure/providers/oracle.py
class Oracle(ProveedorAbstracto):
    def crear_vm(self) -> MachineVirtual:
        # Implementaci√≥n de Oracle
        pass

# 2. Registrar (NO es modificaci√≥n, es configuraci√≥n)
VMProviderFactory.register_provider('oracle', Oracle)
```

**‚úÖ Cumplimiento:**
- Factory NO cambi√≥ internamente
- Solo agregamos nueva clase que cumple contrato existente
- M√©todo `register_provider()` permite extensi√≥n

#### Ejemplo 2: Agregar Nuevo Preset en Director

**ANTES:**
```python
class VMDirector:
    def build_minimal_vm(self, name): ...
    def build_standard_vm(self, name, location): ...
    def build_high_performance_vm(self, name, location): ...
```

**DESPU√âS (Agregar "database-optimized"):**
```python
class VMDirector:
    # M√©todos existentes NO cambian
    def build_minimal_vm(self, name): ...
    def build_standard_vm(self, name, location): ...
    def build_high_performance_vm(self, name, location): ...

    # EXTENSI√ìN: Nuevo m√©todo
    def build_database_optimized_vm(self, name, location): ...
```

**‚úÖ Cumplimiento:**
- M√©todos existentes cerrados para modificaci√≥n
- Clase abierta para extensi√≥n (nuevos m√©todos)
- No rompe c√≥digo cliente existente

#### Test que Valida OCP:
```python
# tests/test_all.py
def test_ocp_open_closed(self):
    """Valida que podemos extender sin modificar"""
    initial_providers = VMProviderFactory.get_available_providers()

    # EXTENSI√ìN: Agregar nuevo proveedor
    class NewProvider(AWS):
        pass

    VMProviderFactory.register_provider('newprovider', NewProvider)

    new_providers = VMProviderFactory.get_available_providers()
    self.assertGreater(len(new_providers), len(initial_providers))
    # ‚úÖ Extendimos sin modificar c√≥digo existente
```

**Tabla de Extensibilidad:**

| Componente | C√≥mo extender | Sin modificar |
|------------|---------------|---------------|
| Proveedores | Crear clase que implemente `ProveedorAbstracto` | Factory, Service, API |
| Builders | Crear clase que extienda `VMBuilder` | BuilderFactory, Service, API |
| Presets | Agregar m√©todo en `VMDirector` | Builders, Factory |
| Endpoints | Agregar ruta en Flask | Services, Domain |

---

### üî∑ L - Liskov Substitution Principle (LSP)

**Definici√≥n:**
> Los objetos de una superclase deben poder ser reemplazados por objetos de sus subclases sin afectar la correctitud del programa.

**Aplicaci√≥n en el Proyecto:**

#### Ejemplo 1: Sustituci√≥n de Proveedores

```python
# Funci√≥n que usa ProveedorAbstracto (superclase)
def provisionar_cualquier_vm(provider: ProveedorAbstracto) -> MachineVirtual:
    """Funci√≥n que acepta cualquier proveedor"""
    if not provider.estado():
        raise Exception("Proveedor no disponible")

    vm = provider.provisionar()  # Polimorfismo
    return vm

# Todos los proveedores pueden sustituir a ProveedorAbstracto
aws_provider = AWS({'type': 't2.micro'})
azure_provider = Azure({'type': 'Standard_B1s'})
google_provider = Google({'type': 'n1-standard-1'})

# LSP: Cualquier proveedor funciona
vm1 = provisionar_cualquier_vm(aws_provider)      # ‚úÖ Funciona
vm2 = provisionar_cualquier_vm(azure_provider)    # ‚úÖ Funciona
vm3 = provisionar_cualquier_vm(google_provider)   # ‚úÖ Funciona
```

**‚úÖ Cumplimiento:**
- Cualquier `ProveedorAbstracto` puede usarse donde se espere uno
- Todos implementan `provisionar()` correctamente
- Todos retornan `MachineVirtual` v√°lida
- Ninguno rompe el contrato de la superclase

#### Ejemplo 2: Sustituci√≥n de Builders

```python
def construir_con_cualquier_builder(builder: VMBuilder) -> MachineVirtual:
    """Funci√≥n que acepta cualquier builder"""
    return (builder
            .reset()
            .set_basic_config("test", "standard")
            .set_compute_resources(cpu=2, ram=4)
            .build())

# Todos los builders pueden sustituir a VMBuilder
aws_builder = AWSVMBuilder()
azure_builder = AzureVMBuilder()

# LSP: Cualquier builder funciona
vm1 = construir_con_cualquier_builder(aws_builder)    # ‚úÖ Funciona
vm2 = construir_con_cualquier_builder(azure_builder)  # ‚úÖ Funciona
```

#### Test que Valida LSP:
```python
# tests/test_all.py
def test_lsp_liskov_substitution(self):
    """Valida que subclases pueden sustituir a superclase"""
    providers = [
        AWS({'type': 't2.micro'}),
        Azure({'type': 'Standard_B1s'}),
        Google({'type': 'n1-standard-1'}),
        OnPremise({'cpu': 2})
    ]

    for provider in providers:
        # Todos son ProveedorAbstracto
        self.assertIsInstance(provider, ProveedorAbstracto)

        # Todos pueden provisionar (mismo comportamiento)
        vm = provider.provisionar()
        self.assertIsNotNone(vm)

        # Todos retornan MachineVirtual v√°lida
        self.assertIsInstance(vm, MachineVirtual)
        self.assertEqual(vm.status, VMStatus.RUNNING)
        # ‚úÖ LSP cumplido: cualquier proveedor funciona igual
```

**Contratos que Deben Cumplirse:**

| Contrato | Implementado en todos |
|----------|---------------------|
| `provisionar()` retorna `MachineVirtual` | ‚úÖ AWS, Azure, Google, OnPremise |
| `estado()` retorna `bool` | ‚úÖ Todos |
| `crear_vm()` retorna `MachineVirtual` con status RUNNING | ‚úÖ Todos |
| `build()` retorna VM con Network y Storage | ‚úÖ Todos los builders |

**Precondiciones y Postcondiciones:**

```python
# Precondici√≥n: provider debe estar disponible
assert provider.estado() == True

# Acci√≥n
vm = provider.provisionar()

# Postcondiciones:
assert vm is not None
assert vm.status == VMStatus.RUNNING
assert vm.provider in ['aws', 'azure', 'google', 'on-premise']
assert vm.network is not None
assert len(vm.disks) > 0
# ‚úÖ Todas las subclases cumplen las postcondiciones
```

---

### üî∑ I - Interface Segregation Principle (ISP)

**Definici√≥n:**
> Los clientes no deben ser forzados a depender de interfaces que no usan.

**Aplicaci√≥n en el Proyecto:**

#### Ejemplo 1: Interfaces Espec√≠ficas

**‚ùå MAL (Interfaz "God" que viola ISP):**
```python
class CloudProviderInterface:
    """Interfaz monol√≠tica con todo"""
    def provisionar_vm(self): pass
    def crear_vm(self): pass
    def crear_network(self): pass
    def crear_storage(self): pass
    def estado(self): pass
    def validar(self): pass
    def conectar_api(self): pass
    def autenticar(self): pass
    def get_precios(self): pass  # No todos necesitan esto
    def get_metricas(self): pass  # No todos necesitan esto
```

**‚úÖ BIEN (Interfaces segregadas):**
```python
# Interface 1: Solo para aprovisionar
class ProveedorAbstracto(ABC):
    """Interfaz espec√≠fica para aprovisionamiento"""
    @abstractmethod
    def crear_vm(self) -> MachineVirtual: pass

    @abstractmethod
    def estado(self) -> bool: pass

    def provisionar(self) -> MachineVirtual:
        return self.crear_vm()

# Interface 2: Solo para construir
class VMBuilder(ABC):
    """Interfaz espec√≠fica para construcci√≥n"""
    @abstractmethod
    def reset(self) -> 'VMBuilder': pass

    @abstractmethod
    def set_basic_config(self, name, vm_type) -> 'VMBuilder': pass

    @abstractmethod
    def build(self) -> MachineVirtual: pass
```

**‚úÖ Cumplimiento:**
- `ProveedorAbstracto` solo tiene m√©todos para aprovisionamiento
- `VMBuilder` solo tiene m√©todos para construcci√≥n
- Clientes usan solo lo que necesitan

#### Ejemplo 2: Service Layer Segregado

```python
# Service 1: Solo Factory Pattern
class VMProvisioningService:
    """Solo para aprovisionamiento r√°pido"""
    def provision_vm(self, provider, config): ...

# Service 2: Solo Builder Pattern
class VMBuildingService:
    """Solo para construcci√≥n detallada"""
    def build_vm_with_config(self, provider, build_config): ...
    def build_predefined_vm(self, provider, preset, name, location): ...
```

**‚úÖ Cumplimiento:**
- Clientes que necesitan aprovisionamiento r√°pido usan `VMProvisioningService`
- Clientes que necesitan construcci√≥n detallada usan `VMBuildingService`
- No hay m√©todos innecesarios en cada servicio

**Tabla de Segregaci√≥n:**

| Cliente | Interfaz que Usa | M√©todos Necesarios | M√©todos No Usa |
|---------|------------------|-------------------|----------------|
| Factory Service | `ProveedorAbstracto` | `provisionar()`, `estado()` | Ninguno ‚úÖ |
| Builder Service | `VMBuilder` | `set_*()`, `build()` | Ninguno ‚úÖ |
| Director | `VMBuilder` | `reset()`, `set_*()`, `build()` | Ninguno ‚úÖ |
| API Layer | `VMProvisioningService`, `VMBuildingService` | `provision_vm()`, `build_vm_*()` | Ninguno ‚úÖ |

---

### üî∑ D - Dependency Inversion Principle (DIP)

**Definici√≥n:**
> Los m√≥dulos de alto nivel no deben depender de m√≥dulos de bajo nivel. Ambos deben depender de abstracciones.

**Aplicaci√≥n en el Proyecto:**

#### Ejemplo 1: Service Depende de Abstracci√≥n

**‚ùå MAL (Violando DIP):**
```python
class VMProvisioningService:
    """Depende de implementaciones concretas"""
    def provision_vm(self, provider_type, config):
        # Acoplado a clases concretas
        if provider_type == 'aws':
            provider = AWS(config)  # ‚ùå Dependencia concreta
        elif provider_type == 'azure':
            provider = Azure(config)  # ‚ùå Dependencia concreta
        # ...
        vm = provider.provisionar()
```

**‚úÖ BIEN (Cumpliendo DIP):**
```python
class VMProvisioningService:
    """Depende de abstracci√≥n (ProveedorAbstracto)"""
    def provision_vm(self, provider_type: str, config: Dict) -> ProvisioningResult:
        # Delega creaci√≥n a Factory (tambi√©n abstracci√≥n)
        provider: ProveedorAbstracto = self.orchestrator.get_validated_provider(
            provider_type, config
        )  # ‚úÖ Retorna abstracci√≥n

        # Trabaja con abstracci√≥n, no con implementaci√≥n
        vm = provider.provisionar()  # ‚úÖ Polimorfismo
        return ProvisioningResult(...)
```

**Diagrama de Dependencias:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Application Layer             ‚îÇ
‚îÇ   VMProvisioningService         ‚îÇ
‚îÇ   VMBuildingService             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ Depende de ‚Üì (Abstracci√≥n)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Domain Layer                  ‚îÇ
‚îÇ   ProveedorAbstracto            ‚îÇ <<interface>>
‚îÇ   VMBuilder                     ‚îÇ <<abstract>>
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ Implementado por ‚Üë
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Infrastructure Layer          ‚îÇ
‚îÇ   AWS, Azure, Google            ‚îÇ
‚îÇ   AWSVMBuilder, AzureVMBuilder  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**‚úÖ Cumplimiento:**
- Application Layer NO importa clases de Infrastructure
- Application Layer solo conoce interfaces del Domain
- Infrastructure implementa las interfaces

#### Ejemplo 2: Director Depende de Abstracci√≥n

```python
class VMDirector:
    """Director depende de VMBuilder (abstracci√≥n)"""
    def __init__(self, builder: VMBuilder):
        # ‚úÖ Recibe abstracci√≥n, no implementaci√≥n concreta
        self._builder = builder

    def build_standard_vm(self, name, location):
        # ‚úÖ Usa m√©todos de la abstracci√≥n
        return (self._builder
                .reset()
                .set_basic_config(name, "standard")
                .build())

# Uso
aws_builder = AWSVMBuilder()  # Implementaci√≥n concreta
director = VMDirector(aws_builder)  # ‚úÖ Inyecci√≥n de dependencia
```

**Inyecci√≥n de Dependencias:**

```python
# Infrastructure crea implementaciones
aws_builder = AWSVMBuilder()

# Application recibe abstracciones
director = VMDirector(aws_builder)  # DIP: Director no conoce AWSVMBuilder
vm = director.build_standard_vm("test", "us-east-1")
```

**Test que Valida DIP:**
```python
def test_dip_dependency_inversion(self):
    """Valida que dependemos de abstracciones"""
    # Factory retorna abstracci√≥n, no implementaci√≥n
    provider = VMProviderFactory.create_provider('aws', {'type': 't2.micro'})

    # ‚úÖ provider es ProveedorAbstracto, no AWS
    self.assertIsInstance(provider, ProveedorAbstracto)

    # Service trabaja con abstracci√≥n
    # No conoce ni le importa si es AWS, Azure, etc.
```

**Tabla de Inversi√≥n:**

| M√≥dulo Alto Nivel | Depende de (Abstracci√≥n) | NO depende de (Implementaci√≥n) |
|-------------------|-------------------------|-------------------------------|
| VMProvisioningService | `ProveedorAbstracto` | AWS, Azure, Google |
| VMBuildingService | `VMBuilder` | AWSVMBuilder, AzureVMBuilder |
| VMDirector | `VMBuilder` | Builders concretos |
| API Layer | Services (Application) | Providers, Builders (Infrastructure) |

---

## 6. ARQUITECTURA DEL SISTEMA

### üìê Vista de Alto Nivel

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         CLIENTE / USUARIO                        ‚îÇ
‚îÇ                    (curl, Postman, Frontend)                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ HTTP Requests
                               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         API LAYER (Flask)                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ /health      ‚îÇ  ‚îÇ /api/providers‚îÇ  ‚îÇ/api/vm/provision    ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ/api/vm/build ‚îÇ  ‚îÇ/api/vm/build/preset                    ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ Calls Services
                               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    APPLICATION LAYER (Services)                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ VMProvisioningService   ‚îÇ  ‚îÇ VMBuildingService            ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ - provision_vm()        ‚îÇ  ‚îÇ - build_vm_with_config()     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚îÇ - build_predefined_vm()      ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ VMProviderFactory       ‚îÇ  ‚îÇ VMBuilderFactory             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ - create_provider()     ‚îÇ  ‚îÇ - create_builder()           ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ Uses Interfaces
                               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     DOMAIN LAYER (Business Logic)                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ ProveedorAbstracto      ‚îÇ  ‚îÇ VMBuilder                    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ <<interface>>           ‚îÇ  ‚îÇ <<abstract>>                 ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ VMDirector              ‚îÇ  ‚îÇ Entities                     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚îÇ - MachineVirtual             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚îÇ - Network                    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ  ‚îÇ - StorageDisk                ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ Implemented by
                               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              INFRASTRUCTURE LAYER (Implementations)              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Providers               ‚îÇ  ‚îÇ Builders                     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ - AWS                   ‚îÇ  ‚îÇ - AWSVMBuilder               ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ - Azure                 ‚îÇ  ‚îÇ - AzureVMBuilder             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ - Google                ‚îÇ  ‚îÇ - GoogleVMBuilder            ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ - OnPremise             ‚îÇ  ‚îÇ - OnPremiseVMBuilder         ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### üîÑ Flujo de Datos Completo

#### Escenario 1: Provisi√≥n con Factory Pattern

```
1. Cliente ‚Üí POST /api/vm/provision
   Body: {
     "provider": "aws",
     "config": {"type": "t2.micro"}
   }

2. API (main.py) ‚Üí provision_vm()
   - Valida JSON
   - Extrae provider y config

3. API ‚Üí VMProvisioningService.provision_vm("aws", config)

4. VMProvisioningService ‚Üí VMProviderFactory.create_provider("aws", config)

5. VMProviderFactory ‚Üí AWS(config)
   - Instancia clase AWS
   - Retorna como ProveedorAbstracto

6. VMProvisioningService ‚Üí provider.provisionar()

7. AWS ‚Üí crear_vm()
   - Crea Network (VPC de AWS)
   - Crea StorageDisk (EBS de AWS)
   - Crea MachineVirtual
   - Ensambla todo

8. AWS ‚Üí Retorna MachineVirtual

9. VMProvisioningService ‚Üí ProvisioningResult
   - success: true
   - vm_id: "aws-xxx"
   - vm_details: {...}

10. API ‚Üí jsonify(result.to_dict())

11. Cliente ‚Üê HTTP 200 OK
    {
      "success": true,
      "vm_id": "aws-xxx",
      ...
    }
```

#### Escenario 2: Construcci√≥n con Builder Pattern

```
1. Cliente ‚Üí POST /api/vm/build
   Body: {
     "provider": "azure",
     "build_config": {
       "name": "prod-db",
       "vm_type": "high-performance",
       "cpu": 8,
       "ram": 32,
       "disk_gb": 500,
       "disk_type": "ssd",
       "location": "eastus"
     }
   }

2. API ‚Üí build_vm()
   - Valida JSON
   - Extrae provider y build_config

3. API ‚Üí VMBuildingService.build_vm_with_config("azure", build_config)

4. VMBuildingService ‚Üí VMBuilderFactory.create_builder("azure")

5. VMBuilderFactory ‚Üí AzureVMBuilder()
   - Instancia clase AzureVMBuilder
   - Retorna como VMBuilder

6. VMBuildingService ‚Üí Construye paso a paso:
   builder.reset()
   builder.set_basic_config("prod-db", "high-performance")
   builder.set_compute_resources(cpu=8, ram=32)
   builder.set_storage(size_gb=500, disk_type="ssd")
   builder.set_location("eastus")

7. VMBuildingService ‚Üí builder.build()

8. AzureVMBuilder ‚Üí build()
   - Mapea configuraci√≥n a Azure specifics
   - Crea Network (VNet de Azure)
   - Crea StorageDisk (Managed Disk de Azure)
   - Crea MachineVirtual (D8s_v3 o similar)
   - Ensambla todo

9. AzureVMBuilder ‚Üí Retorna MachineVirtual

10. VMBuildingService ‚Üí ProvisioningResult

11. API ‚Üí jsonify(result.to_dict())

12. Cliente ‚Üê HTTP 200 OK
    {
      "success": true,
      "vm_id": "azure-xxx",
      "message": "VM construida exitosamente en azure usando Builder Pattern",
      ...
    }
```

#### Escenario 3: Preset con Director Pattern

```
1. Cliente ‚Üí POST /api/vm/build/preset
   Body: {
     "provider": "google",
     "preset": "high-performance",
     "name": "analytics-server",
     "location": "us-central1-a"
   }

2. API ‚Üí build_vm_preset()

3. API ‚Üí VMBuildingService.build_predefined_vm("google", "high-performance", "analytics-server", "us-central1-a")

4. VMBuildingService ‚Üí VMBuilderFactory.create_builder("google")

5. VMBuilderFactory ‚Üí GoogleVMBuilder()

6. VMBuildingService ‚Üí VMDirector(builder)

7. VMBuildingService ‚Üí director.build_high_performance_vm("analytics-server", "us-central1-a")

8. VMDirector ‚Üí Ejecuta secuencia predefinida:
   builder.reset()
   builder.set_basic_config("analytics-server", "high-performance")
   builder.set_location("us-central1-a")
   builder.set_compute_resources(cpu=8, ram=32)
   builder.set_storage(size_gb=500, disk_type="ssd")
   builder.set_network()
   builder.set_advanced_options({"optimized": True, "monitoring": True})
   builder.build()

9. GoogleVMBuilder ‚Üí build()
   - Mapea a n2-highmem-8 o similar
   - Crea VPC Network de GCP
   - Crea Persistent Disk de GCP
   - Crea Compute Instance

10. GoogleVMBuilder ‚Üí Retorna MachineVirtual

11. VMBuildingService ‚Üí ProvisioningResult

12. API ‚Üí jsonify(result.to_dict())

13. Cliente ‚Üê HTTP 200 OK
```

### üóÇÔ∏è Estructura de Archivos Detallada

```
API-Proveedores/
‚îÇ
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ main.py                        # 6 endpoints REST
‚îÇ       ‚îú‚îÄ‚îÄ health()                   # GET /health
‚îÇ       ‚îú‚îÄ‚îÄ get_providers()            # GET /api/providers
‚îÇ       ‚îú‚îÄ‚îÄ provision_vm()             # POST /api/vm/provision
‚îÇ       ‚îú‚îÄ‚îÄ provision_vm_by_provider() # POST /api/vm/provision/<provider>
‚îÇ       ‚îú‚îÄ‚îÄ build_vm()                 # POST /api/vm/build
‚îÇ       ‚îî‚îÄ‚îÄ build_vm_preset()          # POST /api/vm/build/preset
‚îÇ
‚îú‚îÄ‚îÄ application/
‚îÇ   ‚îú‚îÄ‚îÄ factory.py                     # Services y Factories
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ VMProviderFactory          # Factory para proveedores
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ VMProvisioningService      # Service para Factory Pattern
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ VMBuilderFactory           # Factory para builders
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ VMBuildingService          # Service para Builder Pattern
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ schemas.py                     # Validaci√≥n con Pydantic
‚îÇ       ‚îú‚îÄ‚îÄ AWSConfig                  # Schema para AWS
‚îÇ       ‚îú‚îÄ‚îÄ AzureConfig                # Schema para Azure
‚îÇ       ‚îú‚îÄ‚îÄ GoogleConfig               # Schema para Google
‚îÇ       ‚îî‚îÄ‚îÄ OnPremiseConfig            # Schema para OnPremise
‚îÇ
‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îú‚îÄ‚îÄ builder.py                     # Builder Pattern
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ VMBuilder                  # Abstract Builder
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ VMDirector                 # Director
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ entities.py                    # Entidades del dominio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MachineVirtual             # Entidad VM
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Network                    # Entidad Network
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StorageDisk                # Entidad Storage
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ VMStatus                   # Enum de estados
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ProvisioningResult         # Resultado de aprovisionamiento
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ interfaces.py                  # Interfaces abstractas
‚îÇ       ‚îî‚îÄ‚îÄ ProveedorAbstracto         # Interface para proveedores
‚îÇ
‚îú‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îú‚îÄ‚îÄ providers/                     # Implementaciones de proveedores
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aws.py                     # AWS provider
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ azure.py                   # Azure provider
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ google.py                  # Google provider
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ onpremise.py               # OnPremise provider
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ builders/                      # Implementaciones de builders
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ aws_builder.py             # AWS builder
‚îÇ       ‚îú‚îÄ‚îÄ azure_builder.py           # Azure builder
‚îÇ       ‚îú‚îÄ‚îÄ google_builder.py          # Google builder
‚îÇ       ‚îî‚îÄ‚îÄ onpremise_builder.py       # OnPremise builder
‚îÇ
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ test_all.py                    # 31 tests Factory Pattern
‚îÇ   ‚îú‚îÄ‚îÄ test_builder.py                # 32 tests Builder Pattern
‚îÇ   ‚îî‚îÄ‚îÄ test_api_endpoints.py          # Tests de integraci√≥n API
‚îÇ
‚îú‚îÄ‚îÄ requirements.txt                   # Dependencias
‚îú‚îÄ‚îÄ setup.py                           # Configuraci√≥n del paquete
‚îú‚îÄ‚îÄ README.md                          # Documentaci√≥n principal
‚îú‚îÄ‚îÄ IMPLEMENTACION_BUILDER.md          # Detalles del Builder
‚îú‚îÄ‚îÄ QUICKSTART.md                      # Gu√≠a r√°pida
‚îú‚îÄ‚îÄ SUSTENTACION_COMPLETA.md           # Este documento
‚îú‚îÄ‚îÄ test_examples.py                   # Ejemplos autom√°ticos
‚îî‚îÄ‚îÄ WS3-Builder.pdf                    # Especificaciones originales
```

### üìä M√©tricas del Proyecto

```
L√≠neas de C√≥digo:
‚îú‚îÄ‚îÄ Domain Layer: ~600 l√≠neas
‚îú‚îÄ‚îÄ Infrastructure Layer: ~1200 l√≠neas
‚îÇ   ‚îú‚îÄ‚îÄ Providers: ~600 l√≠neas
‚îÇ   ‚îî‚îÄ‚îÄ Builders: ~600 l√≠neas
‚îú‚îÄ‚îÄ Application Layer: ~700 l√≠neas
‚îú‚îÄ‚îÄ API Layer: ~350 l√≠neas
‚îî‚îÄ‚îÄ Tests: ~1100 l√≠neas
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total: ~3950 l√≠neas

Archivos Python:
‚îú‚îÄ‚îÄ Domain: 3 archivos
‚îú‚îÄ‚îÄ Application: 2 archivos
‚îú‚îÄ‚îÄ Infrastructure: 9 archivos
‚îú‚îÄ‚îÄ API: 1 archivo
‚îî‚îÄ‚îÄ Tests: 3 archivos
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total: 18 archivos

Tests:
‚îú‚îÄ‚îÄ Factory Pattern: 31 tests
‚îú‚îÄ‚îÄ Builder Pattern: 32 tests
‚îî‚îÄ‚îÄ API Endpoints: Variable
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total: 63+ tests

Endpoints REST:
‚îú‚îÄ‚îÄ GET: 2 endpoints
‚îî‚îÄ‚îÄ POST: 4 endpoints
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total: 6 endpoints

Patrones de Dise√±o:
‚îú‚îÄ‚îÄ Factory Method: ‚úÖ
‚îú‚îÄ‚îÄ Abstract Factory: ‚úÖ
‚îú‚îÄ‚îÄ Builder: ‚úÖ
‚îî‚îÄ‚îÄ Director: ‚úÖ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total: 4 patrones

Principios SOLID:
‚îú‚îÄ‚îÄ SRP: ‚úÖ
‚îú‚îÄ‚îÄ OCP: ‚úÖ
‚îú‚îÄ‚îÄ LSP: ‚úÖ
‚îú‚îÄ‚îÄ ISP: ‚úÖ
‚îî‚îÄ‚îÄ DIP: ‚úÖ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total: 5/5 (100%)

Proveedores Cloud:
‚îú‚îÄ‚îÄ AWS: ‚úÖ
‚îú‚îÄ‚îÄ Azure: ‚úÖ
‚îú‚îÄ‚îÄ Google Cloud: ‚úÖ
‚îî‚îÄ‚îÄ On-Premise: ‚úÖ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Total: 4 proveedores
```

---

## 7. AN√ÅLISIS DE C√ìDIGO

### üîç An√°lisis Detallado por Componente

#### 7.1 Domain Layer - Builder.py

**Ubicaci√≥n:** `domain/builder.py`

**Responsabilidad:** Define las abstracciones para el patr√≥n Builder y Director

**Componentes Clave:**

```python
class VMBuilder(ABC):
    """
    Builder Abstracto: Define la interfaz para construir VMs paso a paso

    Aplicando:
    - Builder Pattern: Construcci√≥n compleja de objetos paso a paso
    - SRP: Solo se encarga de definir interfaz de construcci√≥n
    - OCP: F√°cil agregar nuevos builders sin modificar esta interfaz
    - Fluent Interface: Cada m√©todo retorna self para encadenamiento
    """

    def __init__(self):
        # Estado interno del builder
        self._vm: Optional[MachineVirtual] = None
        self._network: Optional[Network] = None
        self._disk: Optional[StorageDisk] = None
        self._config: Dict[str, Any] = {}

    @abstractmethod
    def reset(self) -> 'VMBuilder':
        """
        Reinicia el builder para comenzar una nueva construcci√≥n

        ¬øPor qu√©? Permite reutilizar el mismo builder para m√∫ltiples VMs

        Retorna self para Fluent Interface
        """
        pass

    @abstractmethod
    def set_basic_config(self, name: str, vm_type: str) -> 'VMBuilder':
        """
        Configura par√°metros b√°sicos: nombre y tipo de VM

        ¬øPor qu√© separar? Divide responsabilidad en pasos l√≥gicos

        Args:
            name: Nombre identificador de la VM
            vm_type: Tipo (minimal, standard, high-performance, custom)

        Retorna self para Fluent Interface
        """
        pass

    @abstractmethod
    def set_compute_resources(self, cpu: Optional[int], ram: Optional[int]) -> 'VMBuilder':
        """
        Configura recursos de c√≥mputo: CPU y RAM

        ¬øPor qu√© opcional? No siempre se especifica expl√≠citamente

        Args:
            cpu: N√∫mero de CPUs virtuales
            ram: RAM en GB

        Implementaci√≥n espec√≠fica:
        - AWS: Mapea a instance types (t2.micro, m5.large, etc.)
        - Azure: Mapea a VM sizes (D2s_v3, E4s_v3, etc.)
        - Google: Mapea a machine types (e2-standard-2, n2-highmem-4, etc.)
        """
        pass

    @abstractmethod
    def set_storage(self, size_gb: int, disk_type: Optional[str]) -> 'VMBuilder':
        """
        Configura almacenamiento: tama√±o y tipo de disco

        Args:
            size_gb: Tama√±o del disco en GB
            disk_type: Tipo de disco (ssd, standard, io, etc.)

        Implementaci√≥n espec√≠fica:
        - AWS: EBS volumes (gp2, gp3, io2)
        - Azure: Managed disks (Standard_LRS, Premium_LRS)
        - Google: Persistent disks (pd-standard, pd-ssd)
        """
        pass

    @abstractmethod
    def set_network(self, network_id: Optional[str], cidr: Optional[str]) -> 'VMBuilder':
        """
        Configura red: VPC/VNet y rango de IPs

        Args:
            network_id: ID de la red (VPC, VNet, Network)
            cidr: Bloque CIDR (ej: 10.0.0.0/16)
        """
        pass

    @abstractmethod
    def set_location(self, location: str) -> 'VMBuilder':
        """
        Configura ubicaci√≥n: regi√≥n, zona, datacenter

        Args:
            location: Ubicaci√≥n espec√≠fica del proveedor
        """
        pass

    @abstractmethod
    def set_advanced_options(self, options: Dict[str, Any]) -> 'VMBuilder':
        """
        Configura opciones avanzadas espec√≠ficas del proveedor

        ¬øPor qu√© Dict? Permite flexibilidad para opciones espec√≠ficas

        Args:
            options: Diccionario con opciones como:
                - monitoring: bool
                - optimized: bool
                - security_group: str
                - etc.
        """
        pass

    @abstractmethod
    def build(self) -> MachineVirtual:
        """
        Construye y retorna la VM configurada

        Este m√©todo ensambla todos los componentes configurados

        Returns:
            MachineVirtual completamente configurada con Network y Storage
        """
        pass

    def get_config(self) -> Dict[str, Any]:
        """Retorna configuraci√≥n actual (√∫til para debugging)"""
        return self._config.copy()
```

**VMDirector:**

```python
class VMDirector:
    """
    Director: Define el orden de los pasos de construcci√≥n para crear
    configuraciones predefinidas de VMs

    ¬øPor qu√© Director?
    - Encapsula algoritmos de construcci√≥n
    - Define best practices para cada tipo de VM
    - Simplifica uso para clientes finales

    Aplicando:
    - Director Pattern: Encapsula el algoritmo de construcci√≥n
    - SRP: Solo se encarga de orquestar la construcci√≥n
    - Strategy: Diferentes estrategias de construcci√≥n (minimal, standard, high-perf)
    """

    def __init__(self, builder: VMBuilder):
        """
        Constructor que recibe builder

        ¬øPor qu√© inyecci√≥n de dependencia?
        - Director no conoce builder concreto (DIP)
        - Puede trabajar con cualquier builder que implemente VMBuilder
        """
        self._builder = builder

    def change_builder(self, builder: VMBuilder) -> None:
        """
        Cambia el builder utilizado

        ¬øPor qu√©? Permite reutilizar Director con diferentes proveedores
        """
        self._builder = builder

    def build_minimal_vm(self, name: str) -> MachineVirtual:
        """
        Construye una VM con configuraci√≥n m√≠nima (desarrollo/testing)

        Configuraci√≥n:
        - CPU: 1 vCPU
        - RAM: 1 GB
        - Disk: 10 GB

        Uso ideal: Desarrollo, testing, ambientes temporales

        Ejemplo de salida:
        - AWS: t2.micro con EBS de 10GB
        - Azure: Standard_B1s con disco est√°ndar
        """
        return (self._builder
                .reset()
                .set_basic_config(name, "minimal")
                .set_compute_resources(cpu=1, ram=1)
                .set_storage(size_gb=10)
                .build())

    def build_standard_vm(self, name: str, location: str) -> MachineVirtual:
        """
        Construye una VM con configuraci√≥n est√°ndar (aplicaciones web)

        Configuraci√≥n:
        - CPU: 2 vCPU
        - RAM: 4 GB
        - Disk: 50 GB
        - Network: Configurada

        Uso ideal: Aplicaciones web, servicios backend, APIs
        """
        return (self._builder
                .reset()
                .set_basic_config(name, "standard")
                .set_location(location)
                .set_compute_resources(cpu=2, ram=4)
                .set_storage(size_gb=50)
                .set_network()
                .build())

    def build_high_performance_vm(self, name: str, location: str) -> MachineVirtual:
        """
        Construye una VM de alto rendimiento (bases de datos, analytics)

        Configuraci√≥n:
        - CPU: 8 vCPU
        - RAM: 32 GB
        - Disk: 500 GB SSD
        - Network: Configurada
        - Opciones: Optimizada y monitoreada

        Uso ideal: Bases de datos, analytics, procesamiento pesado
        """
        return (self._builder
                .reset()
                .set_basic_config(name, "high-performance")
                .set_location(location)
                .set_compute_resources(cpu=8, ram=32)
                .set_storage(size_gb=500, disk_type="ssd")
                .set_network()
                .set_advanced_options({"optimized": True, "monitoring": True})
                .build())
```

**An√°lisis de Calidad:**

| M√©trica | Valor | Evaluaci√≥n |
|---------|-------|------------|
| **Cohesi√≥n** | Alta | Todos los m√©todos relacionados con construcci√≥n |
| **Acoplamiento** | Bajo | Solo depende de entities (VM, Network, Storage) |
| **Complejidad Ciclom√°tica** | Baja | M√©todos simples, sin l√≥gica compleja |
| **Mantenibilidad** | Excelente | F√°cil agregar nuevos m√©todos |
| **Testabilidad** | Excelente | F√°cil mockear y testear |

---

#### 7.2 Infrastructure Layer - AWS Builder

**Ubicaci√≥n:** `infrastructure/builders/aws_builder.py`

**Responsabilidad:** Implementaci√≥n concreta del Builder para AWS

**An√°lisis de C√≥digo Clave:**

```python
class AWSVMBuilder(VMBuilder):
    """
    Concrete Builder: Implementa construcci√≥n de VMs para AWS

    Responsabilidades:
    1. Mapear configuraciones gen√©ricas a specifics de AWS
    2. Crear recursos compatibles con AWS (VPC, EBS, EC2)
    3. Aplicar nomenclatura y convenciones de AWS
    """

    def __init__(self):
        super().__init__()
        self._config = {
            'provider': 'aws',
            'region': 'us-east-1',  # Default region
            'instance_type': 't2.micro',  # Default instance
            'volume_type': 'gp2',  # Default EBS type
            'size_gb': 20  # Default disk size
        }

    def set_compute_resources(self, cpu: Optional[int], ram: Optional[int]) -> 'AWSVMBuilder':
        """
        Mapea CPU/RAM a instance types de AWS

        L√≥gica de mapeo:
        - 1 CPU, 1GB RAM ‚Üí t2.micro
        - 2 CPU, 4GB RAM ‚Üí t2.small
        - 4 CPU, 16GB RAM ‚Üí t2.large
        - 8 CPU, 32GB RAM ‚Üí t2.xlarge
        """
        if cpu or ram:
            if cpu and ram:
                # Mapeo inteligente
                if cpu <= 1 and ram <= 1:
                    self._config['instance_type'] = 't2.micro'
                elif cpu <= 2 and ram <= 4:
                    self._config['instance_type'] = 't2.small'
                elif cpu <= 4 and ram <= 16:
                    self._config['instance_type'] = 't2.large'
                elif cpu <= 8 and ram <= 32:
                    self._config['instance_type'] = 't2.xlarge'
                else:
                    self._config['instance_type'] = 't2.2xlarge'

            self._config['cpu'] = cpu
            self._config['ram'] = ram
            logger.info(f"AWS Builder: Recursos de c√≥mputo - CPU: {cpu}, RAM: {ram}GB")

        return self  # Fluent Interface

    def set_storage(self, size_gb: int, disk_type: Optional[str]) -> 'AWSVMBuilder':
        """
        Mapea tipos de disco gen√©ricos a EBS volume types

        Mapeo:
        - 'ssd' ‚Üí gp3 (General Purpose SSD, latest generation)
        - 'standard' ‚Üí gp2 (General Purpose SSD)
        - 'magnetic' ‚Üí standard (Old magnetic)
        - 'io' ‚Üí io2 (Provisioned IOPS)
        """
        self._config['size_gb'] = size_gb

        disk_mapping = {
            'ssd': 'gp3',
            'standard': 'gp2',
            'magnetic': 'standard',
            'io': 'io2'
        }

        self._config['volume_type'] = disk_mapping.get(disk_type, 'gp2') if disk_type else 'gp2'
        logger.info(f"AWS Builder: Almacenamiento - {size_gb}GB, Tipo: {self._config['volume_type']}")

        return self

    def build(self) -> MachineVirtual:
        """
        Construye la VM de AWS con toda la configuraci√≥n

        Pasos:
        1. Genera IDs √∫nicos con formato AWS (vpc-, vol-, i-)
        2. Crea Network (VPC) con CIDR block
        3. Crea Disk (EBS Volume) con tipo y tama√±o
        4. Crea MachineVirtual con status RUNNING
        5. Ensambla todo y retorna
        """
        vm_id = f"aws-{uuid.uuid4()}"  # Formato: aws-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

        # Crear Network (VPC)
        network = Network(
            networkId=self._config.get('vpc_id', f"vpc-{uuid.uuid4().hex[:8]}"),
            name=f"aws-net-{self._config.get('region', 'us-east-1')}",
            cidr_block=self._config.get('cidr_block', '10.0.0.0/16'),
            provider='aws'
        )

        # Crear Disk (EBS Volume)
        disk = StorageDisk(
            diskId=f"vol-{uuid.uuid4().hex[:12]}",  # Formato AWS EBS
            name=f"aws-disk-{self._config.get('volume_type', 'gp2')}",
            size_gb=self._config.get('size_gb', 20),
            disk_type=self._config.get('volume_type', 'gp2'),
            provider='aws'
        )

        # Crear VM (EC2 Instance)
        vm = MachineVirtual(
            vmId=vm_id,
            name=self._config.get('name', f"aws-vm-{vm_id[:4]}"),
            status=VMStatus.RUNNING,
            createdAt=datetime.now(),
            provider='aws',
            network=network,
            disks=[disk]
        )

        logger.info(f"AWS Builder: VM construida exitosamente - ID: {vm_id}")

        return vm
```

**Patrones y Pr√°cticas Aplicadas:**

1. **Fluent Interface:**
   - Cada m√©todo retorna `self`
   - Permite encadenar: `builder.set_x().set_y().build()`

2. **Default Values:**
   - Configuraci√≥n inicial con valores sensatos
   - Cliente puede sobrescribir solo lo necesario

3. **Mapping Logic:**
   - Traduce configuraciones gen√©ricas a specifics de AWS
   - Encapsula conocimiento del proveedor

4. **Logging:**
   - Registra cada paso de construcci√≥n
   - Facilita debugging y auditor√≠a

5. **ID Generation:**
   - IDs √∫nicos con UUID
   - Formato consistente con AWS (vpc-, vol-, etc.)

**An√°lisis de Calidad:**

| M√©trica | Valor | Comentario |
|---------|-------|------------|
| **Complejidad Ciclom√°tica** | 5-7 | Aceptable, mapeos if-elif |
| **L√≠neas por M√©todo** | 15-30 | Razonable, f√°cil de leer |
| **Duplicaci√≥n de C√≥digo** | Baja | Similar a otros builders (por dise√±o) |
| **Acoplamiento** | Bajo | Solo depende de entities |
| **Documentaci√≥n** | Excelente | Docstrings completos |

---

## 8. CONCLUSIONES Y RECOMENDACIONES

### ‚úÖ Logros del Proyecto

1. **Cumplimiento Total de Requisitos:**
   - ‚úÖ Todos los RF cumplidos (RF1-RF5)
   - ‚úÖ Todos los RNF cumplidos (RNF1-RNF5)
   - ‚úÖ Todos los par√°metros adicionales implementados
   - ‚úÖ Todos los tipos de m√°quina por proveedor mapeados

2. **Patrones de Dise√±o:**
   - ‚úÖ Factory Method implementado correctamente
   - ‚úÖ Builder Pattern con Fluent Interface
   - ‚úÖ Director Pattern con presets
   - ‚úÖ Abstract Factory impl√≠cito

3. **Principios SOLID:**
   - ‚úÖ SRP en todas las clases
   - ‚úÖ OCP con extensibilidad probada
   - ‚úÖ LSP con sustituci√≥n validada
   - ‚úÖ ISP con interfaces segregadas
   - ‚úÖ DIP con inversi√≥n de dependencias

4. **Calidad del C√≥digo:**
   - ‚úÖ 63 tests unitarios pasando (100%)
   - ‚úÖ Arquitectura limpia y mantenible
   - ‚úÖ Documentaci√≥n exhaustiva
   - ‚úÖ C√≥digo legible y comentado

### üéì Valor Did√°ctico

Este proyecto es excelente material de ense√±anza porque:

1. **Demuestra Patrones Reales:**
   - No son ejemplos toy
   - Resuelven problemas reales
   - Muestran c√≥mo combinan patrones

2. **Aplica SOLID en Pr√°ctica:**
   - Cada principio tiene ejemplos concretos
   - Muestra beneficios tangibles
   - Demuestra consecuencias de violar principios

3. **Arquitectura Profesional:**
   - Clean Architecture aplicada
   - Separaci√≥n clara de capas
   - Dependency Injection
   - API REST profesional

### üöÄ Extensiones Futuras

1. **Nuevos Proveedores:**
   - Oracle Cloud
   - IBM Cloud
   - DigitalOcean
   - Implementaci√≥n: Crear clase y builder, registrar

2. **Nuevos Presets:**
   - GPU-optimized
   - Storage-optimized
   - Network-optimized

3. **Persistencia:**
   - Base de datos para VMs creadas
   - Historial de aprovisionamientos

4. **Monitoreo:**
   - M√©tricas de uso
   - Dashboards
   - Alertas

### üìñ Para Estudiar Este Proyecto

**Orden Recomendado:**

1. **Empezar por Tests:**
   - `tests/test_all.py` - Ver c√≥mo se usa Factory
   - `tests/test_builder.py` - Ver c√≥mo se usa Builder

2. **Revisar Domain:**
   - `domain/entities.py` - Entender entidades
   - `domain/interfaces.py` - Ver abstracciones
   - `domain/builder.py` - Entender Builder y Director

3. **Estudiar Infrastructure:**
   - `infrastructure/providers/aws.py` - Ver implementaci√≥n concreta
   - `infrastructure/builders/aws_builder.py` - Ver builder concreto

4. **Analizar Application:**
   - `application/factory.py` - Ver orquestaci√≥n
   - Entender flujo completo

5. **Probar API:**
   - `api/main.py` - Ver endpoints
   - Ejecutar `test_examples.py`
   - Hacer requests con curl

### üéØ Preguntas para Profundizar

1. **¬øPor qu√© Builder en vez de Constructor Telesc√≥pico?**
   - Constructor con 10 par√°metros es inmantenible
   - Builder permite construcci√≥n opcional y legible
   - Fluent Interface mejora UX

2. **¬øPor qu√© Director adem√°s de Builder?**
   - Director encapsula best practices
   - Simplifica casos comunes
   - No todos los usuarios conocen configuraciones √≥ptimas

3. **¬øPor qu√© Factory Y Builder?**
   - Factory para casos simples y r√°pidos
   - Builder para casos complejos y personalizados
   - Diferentes niveles de abstracci√≥n

4. **¬øC√≥mo garantiza coherencia entre recursos?**
   - Cada provider/builder crea familia de recursos
   - Todos comparten proveedor y regi√≥n
   - Abstract Factory impl√≠cito

5. **¬øC√≥mo se ver√≠a agregar Oracle Cloud?**
   ```python
   # 1. Crear proveedor
   class Oracle(ProveedorAbstracto):
       def crear_vm(self): ...

   # 2. Crear builder
   class OracleVMBuilder(VMBuilder):
       def build(self): ...

   # 3. Registrar
   VMProviderFactory.register_provider('oracle', Oracle)
   VMBuilderFactory._builders['oracle'] = OracleVMBuilder

   # Listo! Ya funciona en toda la API
   ```

---

## üìå RESUMEN EJECUTIVO

### Proyecto: API Multi-Cloud VM Provisioning
### Patrones: Factory Method + Builder + Director
### Cumplimiento: 100% de requisitos del PDF WS3-Builder

**Caracter√≠sticas Principales:**
- ‚úÖ 4 proveedores cloud (AWS, Azure, Google, On-Premise)
- ‚úÖ 6 endpoints REST
- ‚úÖ 2 patrones creacionales combinados
- ‚úÖ 63 tests unitarios (100% passing)
- ‚úÖ 5 principios SOLID aplicados
- ‚úÖ Clean Architecture
- ‚úÖ Documentaci√≥n completa

**Resultados:**
- C√≥digo mantenible y extensible
- Tests aseguran calidad
- Patrones correctamente implementados
- Lista para producci√≥n y ense√±anza

**Valor del Proyecto:**
- Material did√°ctico de calidad
- Ejemplo real de patrones combinados
- Arquitectura profesional
- Base para proyectos futuros

---

## üìö REFERENCIAS

1. **Design Patterns: Elements of Reusable Object-Oriented Software** - Gang of Four
2. **Clean Architecture** - Robert C. Martin
3. **SOLID Principles** - Robert C. Martin
4. **Refactoring Guru** - Design Patterns
5. **PDF WS3-Builder** - Universidad Popular del Cesar

---

**Documento creado por:** Sistema de Aprovisionamiento Multi-Cloud
**Fecha:** 2025
**Versi√≥n:** 1.0
**Universidad Popular del Cesar** - Especializaci√≥n en Ingenier√≠a de Software

---

